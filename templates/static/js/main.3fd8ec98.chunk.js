(this.webpackJsonpvideo=this.webpackJsonpvideo||[]).push([[0],{100:function(e,t,n){e.exports=n(197)},105:function(e,t,n){},110:function(e,t,n){},193:function(e,t){},197:function(e,t,n){"use strict";n.r(t);var a,o,c=n(0),r=n.n(c),s=n(34),u=n.n(s),i=(n(105),n(5)),m=n(16),l=n(87),p=n(50),_=n(36),d={messages:[],userInfo:{username:null!==(a=localStorage.getItem("username"))&&void 0!==a?a:"Anonymous",photo_url:null!==(o=localStorage.getItem("photo_url"))&&void 0!==o?o:"https://i.imgur.com/mCHMpLT.png"},showSettingsModal:!1},f=Object(_.a)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_NAME":var n=t.username;return e.userInfo.username=n,void localStorage.setItem("username",n);case"SET_PHOTO_URL":var a=t.photo_url;return e.userInfo.photo_url=a,void localStorage.setItem("photo_url",a);case"SET_SHOW_MODAL":return void(e.showSettingsModal=t.show);case"SEND_MESSAGE":return void e.messages.push({username:t.username,photo_url:t.photo_url,message:t.message});case"SYNC_CHAT":return void(e.messages=[].concat(Object(p.a)(t.messages),Object(p.a)(e.messages)))}}),d),g=function(e){return{type:"SEND_MESSAGE",message:e.message,username:e.username,photo_url:e.photo_url}},v=f,E={timestampLastChanged:Date.now(),sendTimestamp:!1,link:"https://www.youtube.com/watch?v=2gQhd0_X5eE"},h=Object(_.a)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_LINK":return void(e.link=t.link);case"SET_TOKEN":return void(e.token=t.token);case"SET_SOCKET":return void(e.socket=t.socket);case"PLAY_VIDEO":return void(e.playState=1);case"PAUSE_VIDEO":return void(e.playState=0);case"SET_TIMESTAMP":return e.timestampLastChanged=t.timestampLastChanged,void(t.timestamp&&(e.timestamp=t.timestamp));case"SEND_TIMESTAMP":return void(e.sendTimestamp=!e.sendTimestamp)}}),E),y=function(e){return{type:"SET_LINK",link:e}},O=function(e){var t=e.timestampLastChanged;return{type:"SET_TIMESTAMP",timestamp:e.timestamp,timestampLastChanged:t}},S=h,b=Object(m.combineReducers)({chat:v,session:S}),T=Object(m.createStore)(b,Object(l.composeWithDevTools)(Object(m.applyMiddleware)((function(e){return function(t){return function(n){e.dispatch,e.getState;t(n),n.type}}})))),j=n(99),k=n(4),w=(n(110),n(88)),C=n.n(w),N=n(21),M=n.n(N),I=n(89),A=n.n(I),D=function(){var e=Object(c.useRef)();return r.a.createElement("div",{className:M.a.ctn},r.a.createElement("button",{className:M.a.create,onClick:function(){A.a.get("http://127.0.0.1:8000/",{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(e){var t=e.data;console.log(e.data),window.open("/"+t,"_self")}))}},"Create Room"),r.a.createElement("div",{className:M.a.join},r.a.createElement("input",{type:"text",className:M.a.code,ref:e}),r.a.createElement("button",{className:M.a.joinButton,onClick:function(){var t=e.current.value;window.open("/"+t,"_self")}},"Join")))},L=n(90),x=n(93),P=n.n(x),H=n(94),R=n.n(H),V=function(){var e=Object(i.c)((function(e){return e.session})),t=e.token,n=e.socket,a=e.playState,o=e.timestamp,s=e.timestampLastChanged,u=e.sendTimestamp,m=Object(i.c)((function(e){return e.session.link})),l=Object(c.useRef)(),p=P()(m),_=Object(c.useRef)(!0);return Object(c.useEffect)((function(){console.log("play state changed"),l.current&&(a?l.current.playVideo():l.current.pauseVideo())}),[a]),Object(c.useEffect)((function(){l.current&&l.current.seekTo(o)}),[o]),Object(c.useEffect)((function(){l.current&&(console.log("somebody requested the timestamp"),n.emit("update_timestamp",{timestamp:l.current.getCurrentTime(),room:t}))}),[u]),r.a.createElement(L.a,{videoId:p,opts:{width:"100%",playerVars:{autoplay:1}},className:R.a.player,onReady:function(e){l.current=e.target,l.current.seekTo(o)},onPlay:function(e){_.current?_.current=!1:(console.log(Date.now()-s>500),Date.now()-s>1e3&&n.emit("play_video",{room:t,timestamp:l.current.getCurrentTime()}))},onPause:function(e){n.emit("pause_video",{room:t}),console.log("paused vid")}})},K=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.session})),n=t.token,a=t.link,o=t.socket;return r.a.createElement("div",{style:{color:"white"}},r.a.createElement("div",null,"Token: ",r.a.createElement("input",{type:"text",value:n,readOnly:!0})),r.a.createElement("div",null,"Link: ",r.a.createElement("input",{type:"text",value:a,onChange:function(t){var a=t.target.value;e(y(a)),o.emit("update_link",{room:n,link:a})}})))},Y=n(95),B=n.n(Y),W=n(96),U=n.n(W),J=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.chat.userInfo})),n=Object(i.c)((function(e){return e.chat.showSettingsModal}));return r.a.createElement("div",null,r.a.createElement("img",{src:U.a,style:{width:"20px"},onClick:function(t){e({type:"SET_SHOW_MODAL",show:!n})}}),n&&r.a.createElement("div",null,r.a.createElement("div",null,"name: ",r.a.createElement("input",{type:"text",value:t.username,onChange:function(t){e({type:"SET_NAME",username:t.target.value})}})),r.a.createElement("div",null,"Picture URL: ",r.a.createElement("input",{type:"text",value:t.photo_url,onChange:function(t){e({type:"SET_PHOTO_URL",photo_url:t.target.value})}}))))},X=n(22),q=n.n(X),F=function(e){var t=e.photo_url,n=e.username,a=e.message;return r.a.createElement("div",{className:q.a.ctn},r.a.createElement("div",{className:q.a.user},r.a.createElement("img",{src:t,className:q.a.pic}),r.a.createElement("div",{className:q.a.name},n)),r.a.createElement("div",{className:q.a.message},a))},G=n(97),Q=n.n(G),Z=function(){Object(i.b)();var e=Object(i.c)((function(e){return e.chat.userInfo})),t=e.username,n=e.photo_url,a=Object(i.c)((function(e){return e.session})),o=a.token,c=a.socket;return r.a.createElement("div",{className:Q.a.ctn},r.a.createElement("input",{type:"text",placeholder:"type your message here...",onKeyDown:function(e){if("Enter"===e.key){var a={username:t,photo_url:n,message:e.target.value,room:o};c.emit("chat_message",a),e.target.value=""}}}))},$=function(){var e=Object(i.c)((function(e){return e.chat.messages}));return r.a.createElement("div",{className:B.a.ctn},r.a.createElement(J,null),e.map((function(e,t){return r.a.createElement(F,Object.assign({},e,{key:t}))})),r.a.createElement(Z,null))},z=(n(138),n(98)),ee=n.n(z);function te(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.chat.userInfo})),n=Object(i.c)((function(e){return e.session})),a=n.token,o=(n.timestampLastChanged,Object(k.f)().pathname.slice(1)),s=Object(c.useRef)(!1),u=Object(c.useRef)(!1);return Object(c.useEffect)((function(){var n=ee.a.connect("http://159.89.2.108/"),c=null!==a&&void 0!==a?a:o;n.on("connect",(function(){console.log("connection open"),console.log("sending",c),n.emit("join_room",{photo_url:t.photo_url,username:t.username,room:c})})),n.on("sync_chat",(function(t){s.current||(e({type:"SYNC_CHAT",messages:t.messages}),s.current=!0)})),n.on("connection_message",(function(t){console.log(t),e(g({username:t.username,message:"joined",photo_url:t.photo_url}))})),n.on("chat_message",(function(t){e(g(t))})),n.on("update_link",(function(t){e(y(t.link))})),n.on("pause_video",(function(t){console.log("received pause command"),e({type:"PAUSE_VIDEO"})})),n.on("play_video",(function(t){console.log("received play command",t);var n={timestampLastChanged:Date.now(),timestamp:t.timestamp},a=Date.now()-t.actionStamp;console.log(a),e(O(n)),e({type:"PLAY_VIDEO"})})),n.on("request_timestamp",(function(t){e({type:"SEND_TIMESTAMP"})})),n.on("sync_timestamp",(function(t){if(!u.current){console.log("supposed to sync timestamp",t);var n={timestampLastChanged:Date.now(),timestamp:t.timestamp};e(O(n)),u.current=!0}})),e(function(e){return{type:"SET_SOCKET",socket:e}}(n)),e(function(e){return{type:"SET_TOKEN",token:e}}(o))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:C.a.room},r.a.createElement(V,null),r.a.createElement(K,null)),r.a.createElement($,null))}var ne=function(){return r.a.createElement(i.a,{store:T},r.a.createElement(j.a,null,r.a.createElement(k.c,null,r.a.createElement(k.a,{exact:!0,path:"/",component:D}),r.a.createElement(k.a,{path:"*",component:te}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},21:function(e,t,n){e.exports={ctn:"Home_ctn__1HJDH",create:"Home_create__3Q9FB",code:"Home_code__3XPvS",join:"Home_join__1p59Y",joinButton:"Home_joinButton__3SWT2"}},22:function(e,t,n){e.exports={ctn:"Message_ctn__3Hmod",user:"Message_user__2v6XF",pic:"Message_pic__1493D",name:"Message_name__31XIv",message:"Message_message__12vAk"}},88:function(e,t,n){e.exports={room:"App_room__-_sPV"}},94:function(e,t,n){e.exports={player:"YouTubePlayer_player__3Y8f0"}},95:function(e,t,n){e.exports={ctn:"Chat_ctn__1Z1_d"}},96:function(e,t,n){e.exports=n.p+"static/media/settings.92c25f37.png"},97:function(e,t,n){e.exports={ctn:"Input_ctn__38Mt_"}}},[[100,1,2]]]);
//# sourceMappingURL=main.3fd8ec98.chunk.js.map